unit View_UFrmLogin;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils,
  System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ComCtrls,
  Vcl.StdCtrls, Vcl.ExtCtrls, Vcl.Imaging.pngimage;

type
  TView_FrmLogin = class(TForm)
    GBUsuario: TGroupBox;
    Label1: TLabel;
    Label2: TLabel;
    PSombra2: TPanel;
    PSombra1: TPanel;
    EdtUsuario: TEdit;
    EdtSenha: TEdit;
    BtnEntrar: TButton;
    BtnSair: TButton;
    BarraStatusLogin: TStatusBar;
    ImgLogin: TImage;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure BtnEntrarClick(Sender: TObject);
    procedure BtnSairClick(Sender: TObject);
    procedure FormKeyDown(Sender: TObject; var Key: Word; Shift: TShiftState);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  View_FrmLogin: TView_FrmLogin;

implementation

{$R *.dfm}

uses View_UFrmPrincipal, Controller_Acesso;

procedure TView_FrmLogin.BtnEntrarClick(Sender: TObject);
begin
      //usuário;
      if (EdtUsuario.Text = '') then
       begin

         ShowMessage('AVISO - INFORME USUÁRIO!.');
         EdtUsuario.SetFocus;
         Exit;

       end;

      //Senha;
      if (EdtSenha.Text = '') then
       begin

         ShowMessage('AVISO - INFORME SENHA!.');
         EdtSenha.SetFocus;
         Exit;

       end;

       if (ControllerValidarUsuarioAcesso(EdtUsuario.Text,EdtSenha.Text)=true) then
           begin
             View_FrmPrincipal.BarraStatusPrincipal.Panels[0].Text:=DateToStr(Date);
             View_FrmPrincipal.BarraStatusPrincipal.Panels[2].Text:=UpperCase(EdtUsuario.Text);
             View_FrmPrincipal.BarraStatusPrincipal.Panels[3].Text:=UpperCase('BEM-VINDO AO SISTEMA: '+EdtUsuario.Text);
             View_FrmLogin.Close;
             View_FrmPrincipal.Show;
           end
       else
          begin
            EdtUsuario.Clear;
            EdtSenha.Clear;
            EdtUsuario.SetFocus;
          end;

end;

procedure TView_FrmLogin.BtnSairClick(Sender: TObject);
begin
  Application.Terminate;
end;

procedure TView_FrmLogin.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  Action:=Cafree;
  View_FrmLogin:=nil;
end;

procedure TView_FrmLogin.FormKeyDown(Sender: TObject; var Key: Word;
  Shift: TShiftState);
begin
  //Usando a tecla enter ao invés do Tab.
  if Key = VK_RETURN then Perform(Wm_NextDlgCtl,0,0);
end;

end.
