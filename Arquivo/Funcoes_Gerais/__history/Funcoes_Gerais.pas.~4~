unit Funcoes_Gerais;

interface

uses DateUtils, IniFiles, StrUtils, SysUtils, Dialogs;

//BLOCO FUNÇÕES
Function  LerArquivoIni(NomedaSessao,ValorDaSessao,Variavel:string):string;

implementation

Function  LerArquivoIni(NomedaSessao,ValorDaSessao,Variavel:string):string;
Var ArquivoIni:TIniFile;
begin
  //Verifico Primeiro se tem o arquivo.
  if not FileExists('C:\Windows\System32\config\Config.ini') then
    begin
      ShowMessage('Arquivo de Inicialização não Encontrado,Contate o Suporte.');
      Abort;
    end;
  //caso positivo leio seus dados.
  ArquivoIni:=TIniFile.Create('C:\Windows\System32\config\Config.ini');
  Result:=ArquivoIni.ReadString(NomedaSessao,ValorDaSessao,Variavel);
  ArquivoIni.Free;
end;

end.
